# 应用层
- C/S与P2P模式的特点
- DNS协议、DHCP协议基本工作原理
- SMTP、FTP协议与TELNET协议基本工作原理
- WEB（HTTP）协议与搜索引擎的基本工作原理
- 即时通信与SIP协议基本工作原理
- 网络管理与SNMP协议基本工作原理
- FTP协议工作原理与应用层协议分析方法

## 1 Internet应用与应用层协议分类
### 1.1 Internet应用技术发展三个阶段
- 第一阶段：提供远程登录、电子邮件、文件传输、电子公告牌与网络新闻等基本的网络服务功能
- 第二阶段：基于Web技术的电子政务、电子商务、远程医疗与远程教育应用，搜索引擎技术发展
- P2P网络应用扩大了信息共享模式，无线网络应用扩大了网络应用的灵活性，物联网扩大了网络技术的应用领域

### 1.2 C/S与P2P模式比较
#### 1.2.1 C/S模式
- 采用C/S模式原因：硬件、软件、数据等网络资源分布不均匀
- 工作模式：信息资源的共享是以服务器为中心
- 应用层协议：
    * DNS
    * SMTP
    * FTP
    * Web等

#### 1.2.2 P2P模式
- P2P主要涉及三方面内容
    * P2P通信模式：对等结点直接通信
    * P2P网络：Internet中由对等结点组成的一种动态的逻辑网络
    * P2P实现技术：涉及的协议和软件
- 工作模式：淡化服务提供者与使用者的界限
- 应用层协议：
    * 支持文件共享类Napster与BitTorrent服务的协议
    * 支持多媒体传输类Skype服务的协议等

### 1.3 应用层协议
> 应用层协议规定了应用程序进程之间通信所遵循的通信规则，包括如何构造进程通信报文，报文应该包括哪些字段，每个字段的意义与交互过程。

#### 1.3.1 应用层协议的基本内容
- 交换报文的类型，如请求报文与应答报文
- 每种报文格式与包含的字段类型
- 每个字段意义描述
- 进程在什么时间、如何发送报文，以及如何响应

#### 1.3.2 应用层协议分类
- 基础设施类
    * 域名服务DNS协议
    * 动态主机配置协议DHCP
- 网络应用类
    * 网络终端协议TELNET
    * 电子邮件服务SMTP
    * 文件传输协议FTP
    * Web服务HTTP
- 网络管理
    * 简单网络管理协议SNMP

## 2 域名系统
### 2.1 DNS主要功能
- 域名空间：定义一个包括所有可能出现的主机名字的域名空间
- 域名注册：保证每台主机域名唯一性
- 域名解析：提供一种有效的域名与IP地址转换机制

### 2.2 域名空间结构
- 顶级域名  int edu gov com mil net org...
- 二级域名  ac .com gov bj sh tj....
- 三级域名  tsinghua nankai...
- 四级域名  www cs ee...

### 2.3 域名服务器
- 根域名服务器
- 顶级域名服务器
- 权限域名服务器
- 本地域名服务器

### 2.4 域名解析
> 将域名转换为队形的IP地址的过程称为域名解析。

#### 2.4.1 域名解析算法
- 递归解析
> 如果本地域名服务器没有需要解析的信息，那么本地域名服务器向其他域名服务器请求解析，只将最终结果返回给客户。
- 反复解析
> 如果本地域名服务器不能够返回最终的解析结果，那么它只返回他认为可以解析的域名服务器的IP地址

### 2.5 域名系统性能优化
- 复制
- 缓存

## 3 TELNET协议与远程登录服务
### 3.1 TELNET基本工作原理
> 采用典型的C/S模式，在TELNET客户进程与TELNET服务器进程之间通过网络虚拟终端（NVT）标准进行通信。NVT是一种同一的数据表示方式，以保证不同硬件、软件与数据格式的终端与主机之间通信的兼容性。

## 4 电子邮件服务于SMTP
### 4.1 电子邮件服务基本工作原理
> 邮件客户端使用SMTP向邮件服务器发送邮件，邮件客户端使用POP3协议或IMAP协议从邮件服务器中接收邮件。

### 4.2 SMTP邮件传输过程
- TCP连接建立
- SMTP会话连接建立
- 邮件发送
- SMTP会话连接释放
- TCP连接释放

### 4.3 POP3、IMAP4协议与基于Web的电子邮件
#### 4.3.1  POP3协议工作模式
- 保留模式
> 读取过的邮件仍保存在服务器
- 删除模式
> 读取过的邮件从服务器删除
#### 4.3.2 读取邮件过程
- TCP连接建立
- POP3会话建立
- 邮件事务处理
- 释放POP3会话连接
- 释放TCP连接

#### 4.3.3 IMAP4协议
- 用户在下载邮件之前可以检查邮件头部
- 用户在下载邮件之前可以用特定的字符串搜索电子邮件内容
- 用户可以部分下载电子邮件
- 用户可以在邮件服务器上创建、删除邮箱或对邮箱更名

## 5 Web与基于Web的网路应用

### 5.1 Web服务基本概念

#### 5.1.1 Web服务核心技术
- 超文本传送协议（HTTP）
- 超文本标记语言（HTML）
- 超链接（Hyperlink）
- 统一资源定位符（URL）

#### 5.1.2 主页：网页入口
- 文本
- 图像
- 表格
- 超链接：用于定位其他主页

#### 5.1.3 URL：由协议类型、主机名、路径和文件名组成
http://www.nankai.edu.cn/index.html

#### 5.1.4 超文本传输协议（HTTP）

##### 超文本传输协议基本特点
- 无状态协议：即使是同一个Web浏览器在几秒钟之内两次访问同一个Web服务器，也必须建立两次TCP连接
- 非持续连接与持续连接
    * 非持续连接：如果客户想服务器发出多个服务请求报文，服务器需要对每一个请求报文进行应答，并未每一个应答过程建立一个TCP连接：HTTP1.0默认
    * 持续连接：HTTP1.1默认
- 非流水线与流水线
    * 非流水线：客户端只有在接收到前一个响应时才能发出新的请求
    * 流水线：在没有收到前一个响应时就能发出新请求，服务器端可以连续的发送应答报文。

##### HTTP报文格式
- HTTP请求报文结构：请求行（request line）、报头（header）、空白行（bland line）、正文（body）
- HTTP应答报文结构：状态行、报头、正文，状态行又包括HTTP版本、状态码、状态短语

#### 5.1.5 搜索引擎
##### 基本工作原理
> 返回与“关键字”相关的信息列表，通常包括标题、URL和摘要三方面

#### 搜索引擎的结构
- 搜索器
- 索引器
- 检索器
- 用户接口

## 6 及时通信与会话初始化协议（SIP）
### 6.1 SIP协议特点
- 简介，效率高
- C/S模式
- 地址灵活

### 6.2 SIP协议报文格式
#### 6.2.1 SIP请求报文
报文名称|意义
---|---|
INVITE|邀请用户或服务器参加一个会话，启动会话连接的建立
ACK|用户或服务器同一参加一个会话，确认会话的建立
CANCEL|取消即将发生的会话
BYE|终止会话
INFO|传送PSTN电话信令
OPTIONS|查询一个服务器的能力，如果代理服务器确定能够与用户建立会话连接则应答，如果是注册服务器或重定向服务器则只需转发该报文
#### 6.2.2 ISP应答报文
- 状态码的范围及意义
状态码的范围|意义||状态码的范围|意义
---|---|---|---|---|
100-199|临时的||400-499|客户端错误
200-299|成功||500-599|服务器端错误
300-399|重定向||600-699|失败

#### 6.2.3 ISP协议工作过程
ISP协议工作过程.png

## 7 主机配置与动态主机配置协议
> 动态主机配置协议可以为主机自动分配IP地址及其他一些重要的参数，运行效率高并且支持远程主机、移动设备、无盘工作站的地址共享与配置

### 7.1 DHCP的基本内容
#### 7.1.1 DHCP服务器的主要功能
- 地址储存与管理
- 配置参数的存储和管理
- 租用管理
- 响应客户主机请求
- 服务管理
#### 7.1.2 DHCP客户的主要功能
- 发起配置
- 配置参数管理
- 租用管理
- 报文重传：采用UDP协议

#### 7.1.3 DHCP客户与服务器的交互过程
DHCP客户与服务器交互过程.png

## 8 网络管理与简单网关协议（SNMP）
### 8.1 网络管理系统组成
- 管理进程
- 管理对象
- 代理进程
- 网络管理协议：SNMP、CMIP
- 管理信息库（MIB）

### 8.2 网络管理功能
- 配置管理
- 性能管理
- 记账管理
- 故障管理
- 安全管理

### 8.3 SNMP协议基本内容
- 管理信息结构（SMI）
- 管理信息库（MIB）
- SNMP规则

### 8.4 SNMP基本操作
> 采用轮询方式，周期性通过“读”“写”操作来实现基本的网络管理功能，网络管理进程通过向代理进程发送Get报文检测被管对象状态，使用Set报文改变被管对象状态。

SNMPv3报文类型
操作类型|说明|SNMPv3报文
---|---|---|
读|使用轮询机制从一个被管对象读取管理信息报文|GetRequest-PDU GetNextRequest-PDU GetBulkRequest-PDU
写|改变一个被管对象的管理信息报|SetRequest-PDU
相应|被管对象对请求返回的应答报文|Response-PDU
通知|被管对象向管理进程报告重要事件发生的报文|Trapv2-PDU InformRequest-PDU

#### 管理进程执行Get操作
Get操作.png
#### 管理进程执行Set操作
Set操作.png